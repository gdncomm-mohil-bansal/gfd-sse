# Off2On Service - Visual Overview

## System Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Front-liner PWA (Vue.js)                         â”‚
â”‚                    User Interface for E-commerce                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ HTTP REST API
                             â”‚ (GET /products, POST /cart/add, etc.)
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Off2On Service (THIS)                             â”‚
â”‚                         Spring Boot 3.5.6                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Controllers Layer                                                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚  â”‚  â”‚ ProductControllerâ”‚           â”‚  CartController  â”‚              â”‚ â”‚
â”‚  â”‚  â”‚  /api/products   â”‚           â”‚   /api/cart      â”‚              â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚                               â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Service Layer                            â”‚                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚ â”‚
â”‚  â”‚  â”‚ ProductService   â”‚           â”‚   CartService    â”‚             â”‚ â”‚
â”‚  â”‚  â”‚ - Get products   â”‚           â”‚ - Add to cart    â”‚             â”‚ â”‚
â”‚  â”‚  â”‚ - View product   â”‚           â”‚ - Checkout       â”‚             â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ â”‚
â”‚  â”‚                                           â”‚                        â”‚ â”‚
â”‚  â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚  â”‚                                  â”‚ RedisPublisher    â”‚            â”‚ â”‚
â”‚  â”‚                                  â”‚ Service           â”‚            â”‚ â”‚
â”‚  â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                               â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Event System                             â”‚                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚ CartEvent { eventType, userId, cartItems, totalAmount, ... }  â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜
                                             â”‚ â”‚                        â”‚
                           Publishes to:     â”‚ â”‚                        â”‚
                           - cart-events     â”‚ â”‚                        â”‚
                           - product-events  â”‚ â”‚                        â”‚
                           - checkout-events â”‚ â”‚                        â”‚
                                             â”‚ â”‚                        â”‚
                                             â–¼ â–¼                        â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                              â”‚    Redis Pub/Sub Server     â”‚           â”‚
                              â”‚         Port: 6379          â”‚           â”‚
                              â”‚                             â”‚           â”‚
                              â”‚  Channels:                  â”‚           â”‚
                              â”‚  â€¢ cart-events              â”‚           â”‚
                              â”‚  â€¢ product-events           â”‚           â”‚
                              â”‚  â€¢ checkout-events          â”‚           â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                                             â”‚                          â”‚
                                             â”‚ Subscribes               â”‚
                                             â–¼                          â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                              â”‚   Off2On-replica Service    â”‚           â”‚
                              â”‚      (To be built)          â”‚           â”‚
                              â”‚    Redis Subscriber         â”‚           â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                                             â”‚                          â”‚
                                             â”‚ SSE (Server-Sent Events) â”‚
                                             â–¼                          â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
                              â”‚      GFD PWA (Vue.js)       â”‚           â”‚
                              â”‚  (Admin/Monitoring Interface)           â”‚
                              â”‚  Real-time Event Display    â”‚           â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
                                                                         â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ Future: Authentication/Session
                              â–¼
```

## Component Interaction Diagram

### Add to Cart Flow

```
User Action                  Off2On Service              Redis              Off2On-replica
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚  1. Click "Add to Cart"      â”‚                       â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                       â”‚                      â”‚
    â”‚  POST /api/cart/add          â”‚                       â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 2. Validate           â”‚                      â”‚
    â”‚                              â”‚    Product            â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 3. Update             â”‚                      â”‚
    â”‚                              â”‚    Cart               â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 4. Publish Event      â”‚                      â”‚
    â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                      â”‚
    â”‚                              â”‚  CART_ITEM_ADDED      â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚  5. Success Response         â”‚                       â”‚ 6. Broadcast         â”‚
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
    â”‚  { success: true, ... }      â”‚                       â”‚  Event to Subscribers â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚                       â”‚  7. Forward via SSE  â”‚
    â”‚                              â”‚                       â”‚  to GFD PWA          â”‚
    â”‚                              â”‚                       â”‚                      â”‚
```

### Checkout Flow

```
User Action                  Off2On Service              Redis              Off2On-replica
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚  1. Click "Checkout"         â”‚                       â”‚                      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                       â”‚                      â”‚
    â”‚  POST /api/cart/checkout     â”‚                       â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 2. Validate Cart      â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 3. Calculate Total    â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 4. Generate Order ID  â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 5. Publish Event      â”‚                      â”‚
    â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                      â”‚
    â”‚                              â”‚  CHECKOUT_COMPLETED   â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚ 6. Clear Cart         â”‚                      â”‚
    â”‚                              â”‚                       â”‚ 7. Broadcast         â”‚
    â”‚  8. Order Confirmation       â”‚                       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚  Event to Subscribers â”‚
    â”‚  { orderId: "ORD-XXX", ... } â”‚                       â”‚                      â”‚
    â”‚                              â”‚                       â”‚                      â”‚
    â”‚                              â”‚                       â”‚  9. Notify GFD PWA   â”‚
    â”‚                              â”‚                       â”‚  via SSE             â”‚
```

## Data Models

### Product Model
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Product           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ id: Long              â”‚
â”‚ â€¢ name: String          â”‚
â”‚ â€¢ description: String   â”‚
â”‚ â€¢ price: BigDecimal     â”‚
â”‚ â€¢ category: String      â”‚
â”‚ â€¢ stockQuantity: Integerâ”‚
â”‚ â€¢ imageUrl: String      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cart Item Model
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       CartItem          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ productId: Long       â”‚
â”‚ â€¢ productName: String   â”‚
â”‚ â€¢ price: BigDecimal     â”‚
â”‚ â€¢ quantity: Integer     â”‚
â”‚ â€¢ subtotal: BigDecimal  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cart Event Model
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CartEvent                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ eventId: String (UUID)            â”‚
â”‚ â€¢ eventType: EventType              â”‚
â”‚ â€¢ userId: String                    â”‚
â”‚ â€¢ timestamp: Long                   â”‚
â”‚ â€¢ cartItems: List<CartItem>         â”‚
â”‚ â€¢ totalAmount: BigDecimal           â”‚
â”‚ â€¢ totalItems: Integer               â”‚
â”‚ â€¢ message: String                   â”‚
â”‚ â€¢ metadata: Object                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## API Endpoint Map

```
Off2On Service (Port 8080)
â”‚
â”œâ”€â”€ /api/products
â”‚   â”œâ”€â”€ GET    /                    â†’ Get all products
â”‚   â”œâ”€â”€ GET    /{id}                â†’ Get product by ID
â”‚   â”œâ”€â”€ GET    /category/{category} â†’ Get products by category
â”‚   â””â”€â”€ GET    /health              â†’ Health check
â”‚
â””â”€â”€ /api/cart
    â”œâ”€â”€ POST   /add                 â†’ Add product to cart
    â”œâ”€â”€ GET    /{userId}            â†’ Get user's cart
    â”œâ”€â”€ POST   /checkout            â†’ Checkout cart
    â”œâ”€â”€ DELETE /{userId}            â†’ Clear cart
    â””â”€â”€ GET    /health              â†’ Health check
```

## Redis Channel Structure

```
Redis Pub/Sub
â”‚
â”œâ”€â”€ cart-events
â”‚   â”œâ”€â”€ CART_ITEM_ADDED
â”‚   â”œâ”€â”€ CART_ITEM_REMOVED
â”‚   â””â”€â”€ CART_UPDATED
â”‚
â”œâ”€â”€ product-events
â”‚   â””â”€â”€ PRODUCT_VIEWED
â”‚
â””â”€â”€ checkout-events
    â”œâ”€â”€ CHECKOUT_INITIATED
    â”œâ”€â”€ CHECKOUT_COMPLETED
    â””â”€â”€ CHECKOUT_FAILED
```

## Technology Stack Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Presentation Layer                  â”‚
â”‚  Spring Web Controllers + REST APIs         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Business Logic Layer               â”‚
â”‚  Service Classes (Cart, Product, Redis)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Data Access Layer                   â”‚
â”‚  In-Memory Storage (ConcurrentHashMap)      â”‚
â”‚  Redis Operations (Pub/Sub)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Infrastructure Layer                â”‚
â”‚  Redis Server                               â”‚
â”‚  Spring Boot Embedded Tomcat                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Request/Response Flow

```
HTTP Request
    â”‚
    â”œâ”€â”€â–¶ @RestController
    â”‚       â”‚
    â”‚       â”œâ”€â”€â–¶ Request Validation
    â”‚       â”‚
    â”‚       â”œâ”€â”€â–¶ @Service
    â”‚       â”‚       â”‚
    â”‚       â”‚       â”œâ”€â”€â–¶ Business Logic
    â”‚       â”‚       â”‚
    â”‚       â”‚       â”œâ”€â”€â–¶ Update State (In-Memory)
    â”‚       â”‚       â”‚
    â”‚       â”‚       â””â”€â”€â–¶ RedisPublisher
    â”‚       â”‚               â”‚
    â”‚       â”‚               â”œâ”€â”€â–¶ Serialize to JSON
    â”‚       â”‚               â”‚
    â”‚       â”‚               â””â”€â”€â–¶ Publish to Channel
    â”‚       â”‚
    â”‚       â””â”€â”€â–¶ Build Response
    â”‚
    â””â”€â”€â–¶ HTTP Response (JSON)
```

## Thread Management

```
Tomcat Thread Pool (Default: 200 threads)
    â”‚
    â”œâ”€â”€â–¶ Thread 1: Handle Request A
    â”‚       â”‚
    â”‚       â”œâ”€â”€â–¶ Execute Business Logic
    â”‚       â”œâ”€â”€â–¶ Publish to Redis (Blocking)
    â”‚       â””â”€â”€â–¶ Return Response
    â”‚
    â”œâ”€â”€â–¶ Thread 2: Handle Request B
    â”‚       â”‚
    â”‚       â”œâ”€â”€â–¶ Execute Business Logic
    â”‚       â”œâ”€â”€â–¶ Publish to Redis (Blocking)
    â”‚       â””â”€â”€â–¶ Return Response
    â”‚
    â””â”€â”€â–¶ Thread N: Handle Request N
            â””â”€â”€â–¶ ...

Note: Each request gets its own thread from the pool.
      Redis operations are blocking but fast (~10-20ms).
```

## Storage Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Application Memory                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Product Storage (HashMap)                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ ID â†’ Product                         â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ 1  â†’ Laptop                          â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ 2  â†’ Mouse                           â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ 3  â†’ Keyboard                        â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ ...                                  â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Cart Storage (ConcurrentHashMap)           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚ UserId â†’ List<CartItem>              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ user1  â†’ [Laptop x2, Mouse x1]       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ user2  â†’ [Keyboard x1]               â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ ...                                  â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Organization

```
src/main/java/com/gfd_sse/dummyoff2on/
â”‚
â”œâ”€â”€ ğŸ“ config/              Configuration classes
â”‚   â”œâ”€â”€ CorsConfig         CORS setup
â”‚   â””â”€â”€ RedisConfig        Redis template
â”‚
â”œâ”€â”€ ğŸ“ controller/         REST endpoints
â”‚   â”œâ”€â”€ CartController     Cart APIs
â”‚   â””â”€â”€ ProductController  Product APIs
â”‚
â”œâ”€â”€ ğŸ“ dto/                Data transfer objects
â”‚   â”œâ”€â”€ Request DTOs       API request models
â”‚   â””â”€â”€ Response DTOs      API response models
â”‚
â”œâ”€â”€ ğŸ“ event/              Event system
â”‚   â”œâ”€â”€ CartEvent          Event model
â”‚   â””â”€â”€ EventType          Event types enum
â”‚
â”œâ”€â”€ ğŸ“ exception/          Error handling
â”‚   â””â”€â”€ GlobalExceptionHandler
â”‚
â”œâ”€â”€ ğŸ“ model/              Domain models
â”‚   â”œâ”€â”€ Product            Product entity
â”‚   â””â”€â”€ CartItem           Cart item entity
â”‚
â”œâ”€â”€ ğŸ“ service/            Business logic
â”‚   â”œâ”€â”€ CartService        Cart operations
â”‚   â”œâ”€â”€ ProductService     Product operations
â”‚   â””â”€â”€ RedisPublisher     Event publishing
â”‚
â””â”€â”€ DummyOff2onApplication Main class
```

## Quick Commands Reference

```bash
# Start Redis
docker-compose up -d

# Build project
mvn clean install

# Run application
mvn spring-boot:run

# Test APIs
./test-api.sh

# Monitor events
redis-cli
SUBSCRIBE cart-events

# Check health
curl http://localhost:8080/api/products/health

# Get products
curl http://localhost:8080/api/products

# Add to cart
curl -X POST http://localhost:8080/api/cart/add \
  -H "Content-Type: application/json" \
  -d '{"userId":"user123","productId":1,"quantity":2}'
```

## Success Indicators

âœ… Service starts on port 8080
âœ… Redis connection established
âœ… All endpoints respond with 200 OK
âœ… Events published to Redis channels
âœ… No compilation errors
âœ… No linter warnings
âœ… Documentation complete
âœ… Tests passing

---

**This visual overview provides a quick reference to understand the Off2On service architecture and flow.**

